<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de usuario</title>
    <!-- links para las fuentes -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Grey+Qo&family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/estilos_inicio/registro.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous">

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>




    <link rel="shortcut icon" href="/img_local/logo-pagina-serviapp.png" />

</head>
<body>
    <div class="contenedor">
        <div class="caja-registro">
            <div class="formulario-registro">
                <h2>Regístrate</h2>

                 <!-- mensaje registro exitosos -->
                 <div id="mensaje-exito" style="display: none; color: green; font-weight: bold; margin-bottom: 15px;">
                    ¡Te has registrado exitosamente!
                </div>
                
                <form action="/usuarios/registrar" method="post">
                    <input class="casilla_r" type="text" name="nombre" placeholder="Nombre completo" 
                    pattern="[a-zA-ZáéíóúÁÉÍÓÚñÑ\s]+" title="Solo letras y espacios" 
                    required oninvalid="this.setCustomValidity('Por favor ingresa tu nombre completo usando solo letras y espacios')" 
                    oninput="this.setCustomValidity('')">
                    
                    <input class="casilla_r" type="email" name="email" placeholder="E-mail" required title="Ingresa un correo válido" oninvalid="this.setCustomValidity('Por favor ingresa un correo electrónico válido')" oninput="this.setCustomValidity('')">

                    <div class="password-container">
                        <input class="casilla_r" type="password" id="password" name="password" placeholder="Contraseña"
                            pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[@#$%^&+=]).{8,}"
                            title="Debe contener al menos 8 caracteres, una mayúscula, un número y un carácter especial"
                            required oninvalid="this.setCustomValidity('La contraseña debe tener al menos 8 caracteres, incluyendo una mayúscula, un número y un carácter especial')" 
                            oninput="this.setCustomValidity('')">
                        <span class="icon-eye" id="togglePassword"><i class="fas fa-eye"></i></span>
                    </div>


                    <input class="casilla_r" type="number" name="estrato" placeholder="Estrato" min="1" max="6" step="1" 
                    required oninvalid="this.setCustomValidity('Por favor selecciona un estrato entre 1 y 6')" oninput="this.setCustomValidity('')">

                    <button class="btn_registro" type="submit">Registrar</button>
                </form>
                <p>¿Ya tienes cuenta? <a href="login">Iniciar sesión</a></p>
            </div>
            <div class="imagen">
                <h1>ServiApp</h1>
            </div>
        </div>
    </div>

    <script>
        if (window.location.search.includes('exito=true')) {
            const params = new URLSearchParams(window.location.search);
            const nombreDelUsuario = params.get('nombre') || 'Usuario';
    
            Swal.fire({
                icon: 'success',
                title: `¡Registro exitoso, ${nombreDelUsuario}!`,
                text: 'Bienvenido a ServiApp. Tu cuenta se ha creado correctamente.',
                confirmButtonColor: '#3085d6',
                confirmButtonText: 'Aceptar',
                background: 'linear-gradient(135deg, #f0f8ff, #d0e7ff)',
                customClass: {
                    popup: 'swal-custom-popup'
                },
                didRender: () => {
                    const logo = document.createElement('img');
                    logo.src = '/img_local/logo-pagina-serviapp.png';
                    logo.alt = 'Logo de ServiApp';
                    logo.style.width = '155px';
                    logo.style.display = 'block';
                    logo.style.margin = '0 auto 5px'; // Reducido para menor espacio
                    Swal.getIcon().before(logo);
                }
            });
        }
    </script>
    


    <script src="/javascripts/mensaje_registro_exitoso.js"></script> 
    <script src="/javascripts/ojito_password.js"></script> 
</body>
</html>
